---
layout:     post   				    # ä½¿ç”¨çš„å¸ƒå±€ï¼ˆä¸éœ€è¦æ”¹ï¼‰
title:      å­¦æ ¡æ•™åŠ¡ç³»ç»Ÿä½œä¸šç›‘å¬ 				# æ ‡é¢˜ 
subtitle:   å†™ä¸€ä¸ªç›‘å¬å±±è¥¿å†œä¸šå¤§å­¦è½¯ä»¶å­¦é™¢æ•™åŠ¡ç³»ç»Ÿä½œä¸šçš„å°ç©æ„ #å‰¯æ ‡é¢˜
date:       2019-05-25 				# æ—¶é—´
author:     AchanYao 						# ä½œè€…
header-img: img/post-bg-YesOrNo.jpg 	#è¿™ç¯‡æ–‡ç« æ ‡é¢˜èƒŒæ™¯å›¾ç‰‡
catalog: true 						# æ˜¯å¦å½’æ¡£
tags:								#æ ‡ç­¾
    - å¤§å­¦
    - Java
---

> å…¶å®æˆ‘ä¹Ÿä¸å¤§æ¸…æ¥šæˆ‘æ˜¯ä»¥ä¸€ç§æ€æ ·çš„å¿ƒæ€å†™è¿™ç¯‡åšæ–‡çš„ã€‚  
> ä¹Ÿä¸å¤§æ˜ç™½è¿™ç¯‡ä¸œè¥¿æµä¼ åˆ°è½¯ä»¶å­¦é™¢ä¼šé€ æˆæ€æ ·çš„å½±å“ã€‚  
> å¯æ˜¯æˆ‘è¿˜æ˜¯å†™äº†ã€‚  

## å‰è¨€

è¿™å­¦æœŸåˆï¼Œå­¦é™¢å¼€å‘äº†ä¸€ä¸ªä¾›å­¦ç”Ÿæäº¤ä½œä¸šçš„æ•™åŠ¡ç³»ç»Ÿï¼Œè²Œä¼¼ä»¥åè¿˜æœ‰æœˆè€ƒç³»ç»Ÿï¼Œä¸è¿‡ç°åœ¨å¹¶æ²¡æŠ•å…¥ä½¿ç”¨ï¼Œæˆ‘ä¹Ÿä¸å¤§æ¸…æ¥šã€‚è¿™ä¸ªæ•™åŠ¡ç³»ç»Ÿæœ‰ä¸ªå¼Šç«¯ï¼Œåœ¨è€å¸ˆå¸ƒç½®äº†ä½œä¸šåï¼Œå¹¶ä¸ä¼šç»™å­¦ç”Ÿä¸€ä¸ªåé¦ˆï¼Œä¼šå¯¼è‡´å­¦ç”Ÿé”™è¿‡æäº¤ä½œä¸šçš„æ—¶é—´ã€‚

å¯¹æ­¤æˆ‘åšäº†è¿™ä¹ˆä¸€ä¸ªå°ç©æ„ï¼Œå‘¨å›´ä¸å°‘äººéƒ½åŠæˆ‘å°†å®ƒæ¨å¹¿ï¼Œä½†æ˜¯æˆ‘çŸ¥é“ï¼Œå°±æˆ‘è…¾è®¯äº‘å­¦ç”Ÿæœºå®åœ¨æ‰¿å—ä¸äº†é‚£ä¹ˆå¤§é‡çš„ç”¨æˆ·ï¼Œå°±æ‰“ç®—å…ˆå†™ä¸ªæ–‡æ¡£ï¼Œè¿‡æ®µæ—¶é—´å¼€æºï¼Œå¦‚æœæœ‰éœ€è¦è‡ªå·±æ­å»ºå§ï¼Œå¾ˆé—æ†¾æˆ‘å¸®ä¸äº†é‚£äº›äººã€‚

è™½ç„¶ç›®å‰å°±æˆ‘äº†è§£çš„æƒ…å†µç»å¤§éƒ¨åˆ†è€å¸ˆå¸ƒç½®äº†ä½œä¸šéƒ½ä¼šæé†’ä¸€ä¸‹è‡ªå·±å­¦ç”Ÿï¼Œæˆ‘ä¸çŸ¥é“æˆ‘è¿™ä¸œè¥¿è¿˜æœ‰æ²¡æœ‰ç”¨äº†ï¼Œä¸è¿‡æƒå½“åšä¸ªè®°å½•å§ã€‚æ¯•ç«Ÿæˆ‘çš„ç†å¿µä¸€ç›´å°±æ˜¯å°½è‡ªå·±æ‰€å­¦æ¥è§£æ”¾ç”Ÿäº§åŠ›ã€‚

æœ¬æ–‡ä¸é€‚åˆä¸€æ— æ‰€çŸ¥çš„å°ç™½ã€‚

## æŠ€æœ¯æ ˆ

> åç«¯æœåŠ¡ï¼šHttpServlet  
> æœåŠ¡å™¨ï¼šTomcat  
> æ•°æ®åº“ï¼šMariaDB  
> å¼€å‘ç¯å¢ƒï¼šWin10  
> è¿è¡Œç¯å¢ƒï¼šUbuntu  

1. ç®€å•çš„ç½‘ç»œçˆ¬è™«
    - ç”¨æ¥æŠ“å–APIï¼Œå¯ä»¥ä¸å­¦ç›´æ¥ç”¨æˆ‘æŠ“å–å¥½çš„ã€‚
2. ä½¿ç”¨Javaå‘é€Httpè¯·æ±‚
    - è¿™ç¯‡æ–‡ç« ä¸­æˆ‘ä»‹ç»çš„æ˜¯åŸç”Ÿ`HttpURLConnection`å‘é€è¯·æ±‚ã€‚
3. ä½¿ç”¨Javaè¿æ¥æ•°æ®åº“
    - æˆ‘ä½¿ç”¨çš„æ•°æ®åº“å¼•æ“æ˜¯`Mybatis`ã€‚
4. Javaå‘å®¢æˆ·å‘é€é€šçŸ¥
    - æˆ‘é‡‡ç”¨çš„æ–¹å¼æ˜¯Javaeeå†…ç½®`JavaMail`çš„é‚®ä»¶å‘é€ã€‚
5. Java Timerå®šæ—¶ä»»åŠ¡ç±»

ä»¥ä¸Šæ¡†æ¶æ˜¯å¯ä»¥è·Ÿæ®è‡ªå·±çš„éœ€æ±‚æ¢çš„ï¼Œä¸è¿‡æˆ‘æ˜¯å°½å¯èƒ½ç”¨åŸç”Ÿçš„ã€‚

## ç®€å•APIåˆ†ç¦»

### æ–¹æ³•

è¿™éƒ¨åˆ†æ˜¯ç»™å¤§ä¸€å­¦å¼Ÿå­¦å¦¹çœ‹çš„ï¼Œä¼šçš„è¯·ç›´æ¥è·³è¿‡äº†ï¼Œä¸æƒ³çœ‹çš„ä¹Ÿå¯ä»¥ç›´æ¥è·³è¿‡çš„ã€‚

å†™è¿™ç¯‡åšå®¢çš„æ—¥æœŸæ˜¯19-5-25ï¼Œæ°é€¢æ•™åŠ¡ç³»ç»Ÿåˆåäº†ï¼Œæ‰€ä»¥å®ƒå‘å¸ƒè¿˜ä¸çŸ¥é“å¾—å•¥æ—¶å€™å‘¢ã€‚

æ–¹æ³•æ˜¯æ‰“å¼€æµè§ˆå™¨ï¼ŒæŒ‰ä¸‹f12æ§åˆ¶å°ï¼Œç‚¹å‡»Networkå°±å¯ä»¥è¿›è¡Œç®€å•æŠ“åŒ…äº†ã€‚  
[![å¯¹è½¯ä»¶å­¦é™¢æ•™åŠ¡ç³»ç»Ÿå‡†å¤‡æŠ“åŒ…](https://i.loli.net/2019/05/26/5ce96a234c9b858687.png)](https://i.loli.net/2019/05/26/5ce96a234c9b858687.png)

ç„¶åè¾“å…¥ä½ çš„å­¦å·å¯†ç ç‚¹å‡»ç™»å½•ï¼Œä½ ä¼šå‘ç°Networkä¸‹å¤šäº†ä¸¤ä¸ªè¯·æ±‚ã€‚  
![ç™»å½•è¯·æ±‚](https://i.loli.net/2019/05/26/5cea5f370c19355844.png)

æ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„è¯·æ±‚ï¼Œå•å‡»å°±ä¼šçœ‹åˆ°è¯·æ±‚çš„è¯¦ç»†ç»†èŠ‚ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯å®ƒçš„urlä»¥åŠè§£æå®ƒçš„responseã€‚æ•™åŠ¡ç³»ç»Ÿçš„responseä¹Ÿä¼šç›´æ¥è¾“å‡ºåœ¨æ§åˆ¶å°ä¸Šï¼Œä¹Ÿå¯ä»¥ç›´æ¥çœ‹é‚£ä¸ªã€‚  
![ç™»å½•è¯·æ±‚çš„è¯¦ç»†ä¿¡æ¯](https://i.loli.net/2019/05/26/5cea5fae39d0e87947.png)

è¿™æ˜¯ç™»å½•è¯·æ±‚çš„å“åº”ã€‚  
![ç™»å½•è¯·æ±‚çš„å“åº”](https://i.loli.net/2019/05/26/5cea600a48eff24614.png)

åŒæ ·çš„ï¼Œæˆ‘ä»¬æŠŠæˆ‘çš„ä½œä¸šä¹ŸæŠ“å–äº†ã€‚  
![æˆ‘çš„ä½œä¸šçš„å“åº”](https://i.loli.net/2019/05/26/5cea607ac93fa23477.png)

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œé™¤äº†ç™»å½•è¯·æ±‚ï¼Œå…¶ä½™è¯·æ±‚éƒ½å¸¦æœ‰ä¸ªcookieçš„ï¼Œè¯¥cookieæ˜¯ç”¨æ¥è¯†åˆ«ä½ çš„èº«ä»½çš„ã€‚ä½œç”¨ç®€å•è¯´æ˜ä¸€ä¸‹ï¼šå¦‚æœä½ æ–°æ‰“å¼€ä¸€ä¸ªæ ‡ç­¾é¡µï¼Œè¾“å…¥è½¯ä»¶å­¦é™¢æ•™åŠ¡ç³»ç»Ÿçš„åœ°å€ï¼Œå› ä¸ºæœ‰cookieçš„å­˜åœ¨ï¼Œå®ƒä¼šç›´æ¥ç»™ä½ ç™»å½•ä¸Šå»çš„ã€‚æ‰€ä»¥æˆ‘ä»¬åæ¥çš„è¯·æ±‚ï¼Œä¹Ÿéƒ½å¾—åŠ ä¸Šcookieã€‚  
![å¸¦æœ‰cookieçš„è¯·æ±‚](https://i.loli.net/2019/05/26/5cea61042e6c354650.png)

### API

HOST: `http://sxau.redknot.cn:9080`

#### ç”¨æˆ·ç™»å½•

##### URL

`/student_tmis/student_login/login/login`

##### è¯·æ±‚æ–¹å¼

`POST`

##### è¯·æ±‚å‚æ•°

name|type|desription
----|----|----------
username|String|å­¦å·
password|String|å¯†ç 

##### æ˜¯å¦éœ€è¦cookie

`false`

#### å…¨éƒ¨ä½œä¸š

##### URL

`/student_tmis/student/homework/get_all_homework`

##### è¯·æ±‚æ–¹å¼

`POST`

##### æ˜¯å¦éœ€è¦cookie

`true`

## é€»è¾‘åˆ†æ

APIåˆ†ç¦»å®Œæˆï¼Œæˆ‘ä»¬æ¥æ‹ä¸€æ‹å…·ä½“æ€ä¹ˆåšã€‚æˆ‘çš„æƒ³æ³•æ˜¯ï¼Œä¸€å®šæ—¶é—´é—´éš”ç™»å½•ä¸€æ¬¡ï¼ˆæ¯”å¦‚è¯´40åˆ†é’Ÿï¼‰ï¼Œè·å–åˆ°æ‰€æœ‰ä½œä¸šçš„ä¸ªæ•°ã€‚ä¸‹ä¸€æ¬¡ç™»å½•å†è·å–ä¸€æ¬¡ä½œä¸šçš„ä¸ªæ•°ï¼Œå¦‚æœä¸¤æ¬¡ä¸ªæ•°ä¸ä¸€æ ·ï¼Œå°±è¯´æ˜æœ‰æ–°çš„ä½œä¸šéœ€è¦æäº¤äº†ã€‚

è™½ç„¶çœ‹å“åº”æœ‰ä½œä¸šæœ‰è¢«åˆ é™¤è¿™çŠ¶æ€ï¼Œä½†æ˜¯è²Œä¼¼è¿˜æ˜¯åŠæˆå“ï¼Œè°¨æ…çš„çœ‹å®˜å¯ä»¥æŠŠæœ‰ä½œä¸šçš„æ¡ä»¶æ”¹æˆæœ¬æ¬¡ä½œä¸šä¸ªæ•°å¤§äºä¸Šä¸€æ¬¡çš„ä½œä¸šä¸ªæ•°ã€‚

## ä½¿ç”¨Javaå‘é€Httpè¯·æ±‚

### å‘é€è¯·æ±‚

æ­¤å¤„ä»¥ç™»å½•ä¸ºæ¡ˆä¾‹ï¼Œç¼–å†™ä¸€ä¸ªç™»å½•çš„Servletã€‚

é¦–å…ˆç”Ÿæˆä¸€ä¸ªURLå¯¹è±¡ã€‚  
`new URL(http://sxau.redknot.cn:9080/student_tmis/student_login/login/login?username=" + username + "&password=" + password)`  
å…¶ä¸­usernameå’Œpasswordæ˜¯å‚æ•°ã€‚

é€šè¿‡urlå¯¹è±¡ç”Ÿæˆä¸€ä¸ªè¿æ¥å¯¹è±¡ã€‚å¹¶è®¾ç½®è¯¥å¯¹è±¡çš„å±æ€§ã€‚

```java
        // HttpURLConnection å¯¹è±¡ä¸èƒ½ç›´æ¥æ„é€ ï¼Œéœ€è¦é€šè¿‡openConnection();è·å–
        HttpURLConnection connection = (HttpURLConnection) new URL("http://sxau.redknot.cn:9080/student_tmis/student_login/login/login?username=" + username + "&password=" + password).openConnection();

        // è®¾ç½®æ˜¯å¦ä»HttpUrlConnectionè¯»å…¥ï¼Œé»˜è®¤ä¸ºtrue
        connection.setDoInput(true);
        // è®¾ç½®æ˜¯å¦å‘HttpUrlConnectionè¾“å‡ºï¼Œå› ä¸ºè¿™æ˜¯Postè¯·æ±‚ï¼Œå‚æ•°è¦æ”¾åœ¨httpæ­£æ–‡é‡Œï¼Œæ‰€ä»¥å‚æ•°å¡«å†™true
        // é»˜è®¤ä¸ºfalse
        connection.setDoOutput(true);

        // è®¾ç½®connectionçš„è¯·æ±‚æ–¹å¼ï¼Œé»˜è®¤ä¸ºGET
        connection.setRequestMethod("POST");
```

å› ä¸ºåç»­æ“ä½œéƒ½éœ€è¦cookieï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—è·å–ç™»å½•çš„cookieï¼Œè·å–åˆ°çš„å®é™…ä¸Šæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè‡³äºä¹‹åå­˜å…¥åˆ°å†…å­˜ä¸­è¿˜æ˜¯æ•°æ®åº“ä¸­ï¼Œå„ä½çœ‹å®˜è¯·è‡ªè¡Œå†³å®šã€‚

```java
        Map<String, List<String>> map = connection.getHeaderFields();
        List<String> list = map.get("Set-Cookie");
        String sessionId = null;
        if (list != null) {
            StringBuilder builder = new StringBuilder();
            for (String str : list) {
                builder.append(str).toString();
            }
            sessionId = getSessionId(builder.toString());
        }
```

åŒ¹é…Cookieçš„æ–¹æ³•æ˜¯è¿™æ ·ï¼š

```java
    private String getSessionId(String s) {
        Pattern pattern = Pattern.compile("JSESSIONID=(.*); Path=/; HttpOnly");
        Matcher matcher = pattern.matcher(s);
        if (matcher.find())
            return matcher.group(1);
        else return null;
    }
```

è·å–connectionçš„responseã€‚è¿™å—å»ºè®®å°è£…æˆæ–¹æ³•ã€‚

```java
        // è·å–connectionçš„è¾“å…¥ï¼Œè¿™é‡Œè®¾ç½®ç¼–ç æ ¼å¼ä¸ºutf-8;
        BufferedReader reader = new BufferedReader(new InputStreamReader(connection.getInputStream(), "utf-8"));
        String inputLine;
        // è¿™ä¸ªå¯¹è±¡å°±æ˜¯æˆ‘ä»¬éœ€è¦è·å–çš„å“åº”json
        StringBuffer responseString = new StringBuffer();

        while ((inputLine = reader.readLine()) != null)
            responseString.append(inputLine);
        // è·å–å®Œæˆ
```

è·å–ä½œä¸šçš„Servletæˆ‘å°±ä¸å†è®²è¿°äº†ï¼Œæ— éæ˜¯è¿æ¥ï¼Œç„¶åè·å–å“åº”ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯éœ€è¦ä¼ cookieï¼Œæˆ‘å°±è¯´ä¸€ä¸‹å¦‚ä½•è®¾ç½®cookieå§ã€‚

```java
String cookie = ""; // å‡å¦‚è¯´è¿™æ˜¯ä½ ç™»å½•çš„cookie
connection.setRequestProperty("Cookie", "JSESSIONID=" + cookie);
```

### è§£æå“åº”

æˆ‘ä»¬è·å–åˆ°çš„å“åº”éƒ½æ˜¯Jsonç±»å‹æ•°æ®ï¼Œæ‰€ä»¥é—®é¢˜å°±è½¬åŒ–ä¸ºäº†ï¼Œå¦‚ä½•ç”¨Javaè§£æJsonæ•°æ®ã€‚æ¡†æ¶ä¸€å¤§å †ï¼Œåœ¨è¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯è°·æ­Œçš„Gsonè§£æJsonæ•°æ®ã€‚

ç®€å•åŠŸèƒ½å®ç°åªéœ€è¦çŸ¥é“ä¸€ä¸ªæ–¹æ³•å°±å¥½ï¼š

```java
new Gson().fromJson(json, class); // è¯¥æ–¹æ³•æ˜¯ç”¨æ¥å°†jsonå­—ç¬¦ä¸²è½¬æ¢æˆJavaå¯¹è±¡ï¼ˆclassç±»å‹ï¼‰
```

ä¾‹å¦‚æˆ‘ä»¬è¦å°†ç™»å½•çš„å“åº”è½¬æ¢æˆJavaå¯¹è±¡ï¼Œå°±å¯ä»¥è¿™ä¹ˆå†™ã€‚

```java
String response = ""; // è¿™æ˜¯ä½ çš„å“åº”json
// æˆ‘æƒ³å°†å…¶è§£ææˆé”®å€¼å¯¹å½¢å¼çš„HashMapï¼Œkey-valueçš„ç±»å‹å¯ä»¥è‡ªè¡ŒæŒ‡å®šã€‚å¤æ‚çš„jsonä¸æŒ‡å®šå…·ä½“æ¯ä¸€é¡¹çš„å±æ€§ï¼ŒGsonä¼šè‡ªåŠ¨ç»™ä½ åŒ¹é…ç±»å‹çš„ã€‚
HashMap<String, String> json = new Gson().fromJson(response, HashMap.class);
if (String.valueOf(json.get("code")).equals("200.0")) {
    // ç™»å½•æˆåŠŸ
} else if (String.valueOf(json.get("code")).equals("201.0")) {
    // è´¦å·å¯†ç é”™è¯¯
}
// æ›´å¤šçš„codeæˆ‘æ²¡å»æŠ“ï¼Œåªå¼„äº†è¿™ä¸¤ä¸ªã€‚
```

å› ä¸ºæ˜¯Gsonè‡ªåŠ¨åŒ¹é…ç±»å‹ï¼Œæ‰€ä»¥å®ƒå°†codeè½¬æ¢æˆäº†doubleï¼Œä½†æ˜¯ä½ è¦æ±‚çš„æ˜¯Stringï¼Œæ‰€ä»¥æœ€åå°±å˜æˆäº†å­—ç¬¦ä¸² "200.0"ã€‚æƒ³äº†è§£Gsonå¦‚ä½•ç²¾ç¡®è§£æï¼Œå¯ä»¥å‚è€ƒ[è¿™é‡Œ](https://blog.csdn.net/tkwxty/article/details/34474501)ã€‚

è·å–ä½œä¸šä¸ªæ•°å¯ä»¥è¿™ä¹ˆå†™ï¼š

```java
        String json = getResponseString(connection); // è¿™æ˜¯ä½ è·å–æ‰€æœ‰ä½œä¸šçš„å“åº”
        HashMap<String, Object> temp = new Gson().fromJson(json, HashMap.class);
        return ((ArrayList) temp.get("model")).size(); // å°†modelå¼ºè¡Œè½¬æ¢æˆArrayListç±»å‹
```

## Javaè¿æ¥æ•°æ®åº“

å› ä¸ºæˆ‘æœ‰ç€å¥½äº›ç”¨æˆ·ï¼Œæ‰€ä»¥é‡‡ç”¨äº†æ•°æ®åº“å­˜å‚¨ï¼Œå¦‚æœåªæ˜¯ç»™è‡ªå·±ä½¿ç”¨çš„è¯æ²¡å¿…è¦åƒæˆ‘ä¸€æ ·ã€‚

### è®¾è®¡æ•°æ®åº“

å¤§é‡ç”¨æˆ·ä¸‹ï¼Œç»™æ¯ä¸ªäººéƒ½å¯¹åº”ä¸€å¥—ç›‘å¬æ˜¯ä¸ç°å®çš„ã€‚å­¦æ ¡17å±Šå¤§æ¦‚900å·äººï¼Œä¸€ä¸ªç›‘å¬æ‰€éœ€æ—¶é—´å¤§æ¦‚2-7sä¸ç­‰ï¼Œè§†ç½‘é€Ÿè€Œå®šã€‚å–å¹³å‡5sï¼Œ5*900/60=75ã€‚75åˆ†é’Ÿï¼Œé»„èŠ±èœéƒ½å‡‰äº†ã€‚å¦‚æœè¯´ä½¿ç”¨å¤šçº¿ç¨‹ï¼Œæˆ‘æ€•æœåŠ¡å™¨ç‚¸â•®(â•¯â–½â•°)â•­ã€‚æœ‰å…´è¶£çš„åŒå­¦å€’æ˜¯å¯ä»¥è€ƒè™‘çº¿ç¨‹æ± ï¼Œè®¾ä¸ª3ä¸ªæˆ–4ä¸ªä»»åŠ¡é‡ã€‚åº”è¯¥æ˜¯å¯ä»¥å®ç°çš„ã€‚

è·Ÿæ®ä»¥ä¸Šåˆ†æï¼Œæˆ‘çš„è§£å†³æ–¹æ¡ˆæ˜¯ç»™æ¯ä¸ªç­æ‰¾ä¸ªå‚ç…§å­¦ç”Ÿï¼ˆè¿™ä¸ªå­¦ç”Ÿæœ€å¥½æ˜¯å¹³æ—¥é‡Œæ‡’å¾—çœ‹æ•™åŠ¡ç³»ç»Ÿçš„ï¼Œå½“ç„¶æœ€å…³é”®çš„æ˜¯æ„¿æ„æä¾›æ•™åŠ¡ç³»ç»Ÿå¯†ç çš„ï¼‰ã€‚å¦‚æœè¿™ä¸ªå­¦ç”Ÿæœ‰æ–°ä½œä¸šäº†ï¼Œå°±è¯´æ˜æ•´ä¸ªç­çº§çš„åŒå­¦æœ‰æ–°ä½œä¸šäº†ã€‚

æ•°æ®åº“è®¾è®¡ä¸¤å¼ è¡¨ï¼Œä¸€å¼ referenceï¼Œä¸€å¼ memberï¼Œreferenceå­˜æ”¾å­¦å·å§“åå¯†ç ä¿¡æ¯ï¼Œmemberå­˜æ”¾æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯åŒ…æ‹¬ä½†ä¸é™äºå­¦å·ã€å§“åã€é‚®ç®±ã€‚memberå¯ä»¥ä¸è¦å¯†ç ã€‚

### Mybatisè¿æ¥æ•°æ®åº“

> è¿™ä¸ªæˆ‘æ˜¯çœŸä¸æƒ³è®²äº†ï¼Œå¤§å®¶å‚è€ƒ[æ–‡æ¡£](http://www.mybatis.org/mybatis-3/zh/getting-started.html)å§

1. é…ç½®mybatisç¯å¢ƒ
2. å»ºç«‹POJO
3. ç¼–å†™æ¥å£
4. ç¼–å†™æ˜ å°„ï¼ˆmapperï¼‰æ–‡ä»¶

## JavaMailå‘é€é‚®ä»¶

### é…ç½®JavaMail

æˆ‘åˆ°ç½‘ä¸Šæ‰¾äº†æ‰¾ï¼Œä¹Ÿæ²¡å‘ç°ä»€ä¹ˆå¥½çš„æ•™ç¨‹ï¼Œæ¯•ç«Ÿé‚®ä»¶æ˜¯å¥½äº›å¹´å‰ç”¨çš„äº†ï¼Œç°åœ¨éƒ½æ˜¯å¾®ä¿¡qqå³æ—¶é€šè®¯ã€‚æˆ‘ä¹Ÿè¯´ä¸å‡ºä¸ªæ‰€ä»¥ç„¶æ¥ï¼Œå°±ç›´æ¥æ”¾ä»£ç è®²æ€ä¹ˆé…ç½®å§ã€‚è¿™é‡Œæˆ‘ç”¨çš„æ˜¯qqé‚®ç®±ã€‚

```java
import javax.mail.*;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;
import java.io.UnsupportedEncodingException;
import java.util.Properties;

public class EmailUtil {

    private static final String USER_NAME = ""; // è¿™é‡Œå†™ä½ çš„é‚®ç®±
    private static final String PASSWORD = ""; // è¿™é‡Œå†™ä½ çš„æˆæƒç 
    private static Properties properties = System.getProperties();
    private static Session session;

    static {
        // è¿™é‡Œå„ç§å±æ€§é…ç½®è¯·å‚è€ƒå¯¹åº”é‚®ä»¶æœåŠ¡çš„æ–‡æ¡£
        properties.setProperty("mail.smtps.auth", "true");
        // smtpè·Ÿsmtpsæ˜¯ä¸¤ä¸ªåè®®ï¼Œç®€å•è®²å¯ä»¥æŠŠsmtpså½“ä½œsmtpåŠ å¼ºç‰ˆ
        // è®¾ç½®smtpæœåŠ¡çš„ä¸»æœº
        properties.setProperty("mail.smtps.host", "smtp.qq.com");
        properties.setProperty("mail.smtp.host", "smtp.qq.com");
        // è®¾ç½®smtpæœåŠ¡çš„ç«¯å£
        properties.setProperty("mail.smtp.port", "465");
        // è®¾ç½®é‚®ä»¶å‘é€åè®®
        properties.setProperty("mail.transport.protocol", "smtp");

        properties.setProperty("mail.smtp.socketFactory.class", "javax.net.ssl.SSLSocketFactory");
        properties.setProperty("mail.smtp.socketFactory.port", "465");
        // è·å–é»˜è®¤sessionå¯¹è±¡
        session = Session.getInstance(properties, new Authenticator() {
            public PasswordAuthentication getPasswordAuthentication() {
                // å‘ä»¶äººé‚®ä»¶ç”¨æˆ·åã€å¯†ç ï¼Œå°±æ˜¯ä½ ç™»å½•é‚®ç®±çš„å¯†ç ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä¸€ç›´æ²¡å¼€æºçš„ä¸»è¦åŸå› 
                return new PasswordAuthentication(USER_NAME, "");
            }
        });
    }

    /**
     * åƒæŒ‡å®šæˆå‘˜å‘é€
     * @param to æˆ‘è‡ªå·±å°è£…çš„æˆå‘˜ç±»å‹ï¼Œå…¶å®åªéœ€è¦ç”¨åˆ°é‚®ä»¶åœ°å€å°±è¡Œ
     * @param subject é‚®ä»¶çš„ä¸»é¢˜
     * @param html é‚®ä»¶ä¸»ä½“ï¼Œæˆ‘è¿™é‡Œæ˜¯ç”¨htmlçš„å½¢å¼ï¼Œé»˜è®¤æ˜¯æ–‡æœ¬å½¢å¼
     * @throws MessagingException
     * @throws UnsupportedEncodingException
     */
    public static void sendMessage(Member to, String subject, String html) throws MessagingException, UnsupportedEncodingException {
        MimeMessage message = new MimeMessage(session); // å‘é€é‚®ä»¶çš„ä¼šè¯
        message.setFrom(USER_NAME); // è®¾ç½®é‚®ä»¶å‘ä¿¡äºº
        // è®¾ç½®é‚®ä»¶å¯„ç»™è°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸è¦åŠ¨ï¼Œå› ä¸ºè¿˜æœ‰å¯¹åº”çš„æŠ„é€å•¥çš„ï¼Œè¿™é‡Œä¸åšèµ˜è¿°ã€‚
        // ç¬¬äºŒä¸ªå‚æ•°æ˜¯ç”Ÿæˆä¸€ä¸ªåœ°å€ï¼Œå‚æ•°to.getEmail()æ˜¯è·å–é‚®ä»¶æˆå‘˜emailï¼ˆä¸å¯çœï¼‰ï¼Œto.getName()æ˜¯è·å–ç”¨æˆ·å§“åï¼ˆå¯çœï¼‰
        message.addRecipient(Message.RecipientType.TO, new InternetAddress(to.getEmail(), to.getName()));

        message.setSubject(subject);
        // è®¾ç½®é‚®ä»¶å†…å®¹ï¼Œæ–‡æœ¬çš„è¯ä¸ç”¨å†™ç¬¬äºŒä¸ªå‚æ•°
        message.setContent(html, "text/html; charset=\"utf-8\"");

        Transport transport = session.getTransport();
        transport.connect("smtp.qq.com", USER_NAME, PASSWORD);
        transport.sendMessage(message, message.getAllRecipients());
    }
}
```

### QQé‚®ç®±å¼€å¯smtpæœåŠ¡

ç”µè„‘ä¸Šç™»å½•ä½ çš„QQé‚®ç®±ï¼Œç‚¹å‡»è®¾ç½®ã€‚  
![ç™»å½•é‚®ç®±å¹¶æ‰¾åˆ°è®¾ç½®](https://i.loli.net/2019/05/26/5cea3be8e8fec30215.png)  
ç‚¹å‡»è´¦æˆ·ã€‚  
![ç‚¹å‡»è´¦æˆ·è¿›è¡Œè®¾ç½®](https://i.loli.net/2019/05/26/5cea3e5e4414249518.png)  
æ‰¾åˆ°SMTPæœåŠ¡å¹¶å¼€å¯ï¼Œç‚¹å‡»ç”Ÿæˆæˆæƒç ï¼Œå®ƒä¼šç»™ä½ ä¸€ä¸ªæˆæƒç ã€‚  
![æ‰¾åˆ°SMTPæœåŠ¡å¹¶å¼€å¯](https://i.loli.net/2019/05/26/5cea3f6884e4a32245.png)  
å¡«å†™åˆ°ä»£ç é‡Œå°±è¡Œäº†ã€‚

> QQé‚®ç®±SMTPæœåŠ¡å™¨ç«¯å£å·çœ‹[è¿™é‡Œ](https://service.mail.qq.com/cgi-bin/help?subtype=1&&id=28&&no=369)

## Javaå®šæ—¶ä»»åŠ¡

ä»¥ä¸Šå„ä¸ªç»„ä»¶ç»„è£…åœ¨ä¸€èµ·ï¼Œå°±èƒ½ç”¨äº†ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜ç¼ºå°‘ä¸€ä¸ªç»„è£…çš„å·¥å…·ã€‚ç°åœ¨æˆ‘ä»¬å°±æ¥çœ‹çœ‹Javaçš„Timerå’ŒTimerTaskã€‚

åœ¨ Java ä¸­ä¸€ä¸ªå®Œæ•´å®šæ—¶ä»»åŠ¡éœ€è¦ç”± Timerã€TimerTask ä¸¤ä¸ªç±»æ¥é…åˆå®Œæˆã€‚ API ä¸­æ˜¯è¿™æ ·å®šä¹‰ä»–ä»¬çš„ï¼ŒTimerï¼šä¸€ç§å·¥å…·ï¼Œçº¿ç¨‹ç”¨å…¶å®‰æ’ä»¥ååœ¨åå°çº¿ç¨‹ä¸­æ‰§è¡Œçš„ä»»åŠ¡ã€‚å¯å®‰æ’ä»»åŠ¡æ‰§è¡Œä¸€æ¬¡ï¼Œæˆ–è€…å®šæœŸé‡å¤æ‰§è¡Œã€‚ç”±TimerTaskï¼šTimer å®‰æ’ä¸ºä¸€æ¬¡æ‰§è¡Œæˆ–é‡å¤æ‰§è¡Œçš„ä»»åŠ¡ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·ç†è§£ Timer æ˜¯ä¸€ç§å®šæ—¶å™¨å·¥å…·ï¼Œç”¨æ¥åœ¨ä¸€ä¸ªåå°çº¿ç¨‹è®¡åˆ’æ‰§è¡ŒæŒ‡å®šä»»åŠ¡ï¼Œè€Œ TimerTask ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒçš„å­ç±»ä»£è¡¨ä¸€ä¸ªå¯ä»¥è¢« Timer è®¡åˆ’çš„ä»»åŠ¡ã€‚

### Timer

åœ¨å·¥å…·ç±» Timer ä¸­ï¼Œæä¾›äº†å››ä¸ªæ„é€ æ–¹æ³•ï¼Œæ¯ä¸ªæ„é€ æ–¹æ³•éƒ½å¯åŠ¨äº†è®¡æ—¶å™¨çº¿ç¨‹ï¼ŒåŒæ—¶ Timer ç±»å¯ä»¥ä¿è¯å¤šä¸ªçº¿ç¨‹å¯ä»¥å…±äº«å•ä¸ª Timer å¯¹è±¡è€Œæ— éœ€è¿›è¡Œå¤–éƒ¨åŒæ­¥ï¼Œæ‰€ä»¥ Timer ç±»æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä½†æ˜¯ç”±äºæ¯ä¸€ä¸ª Timer å¯¹è±¡å¯¹åº”çš„æ˜¯å•ä¸ªåå°çº¿ç¨‹ï¼Œç”¨äºé¡ºåºæ‰§è¡Œæ‰€æœ‰çš„è®¡æ—¶å™¨ä»»åŠ¡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬çš„çº¿ç¨‹ä»»åŠ¡æ‰§è¡Œæ‰€æ¶ˆè€—çš„æ—¶é—´åº”è¯¥éå¸¸çŸ­ï¼Œä½†æ˜¯ç”±äºç‰¹æ®Šæƒ…å†µå¯¼è‡´æŸä¸ªå®šæ—¶å™¨ä»»åŠ¡æ‰§è¡Œçš„æ—¶é—´å¤ªé•¿ï¼Œé‚£ä¹ˆä»–å°±ä¼šâ€œç‹¬å â€è®¡æ—¶å™¨çš„ä»»åŠ¡æ‰§è¡Œçº¿ç¨‹ï¼Œå…¶åçš„æ‰€æœ‰çº¿ç¨‹éƒ½å¿…é¡»ç­‰å¾…å®ƒæ‰§è¡Œå®Œï¼Œè¿™å°±ä¼šå»¶è¿Ÿåç»­ä»»åŠ¡çš„æ‰§è¡Œã€‚æ‰€ä»¥è¦ç¡®ä¿TimerTaskçš„æ‰§è¡Œæ—¶é—´çŸ­äºTimeræ‰€ç»™è¿è¡Œæ—¶é—´ã€‚

1. schedule(TimerTask task, Date time);
    - å®‰æ’åœ¨æŒ‡å®šçš„æ—¶é—´æ‰§è¡ŒæŒ‡å®šçš„ä»»åŠ¡ã€‚
2. schedule(TimerTask task, Date firstTime, long period);
    - å®‰æ’æŒ‡å®šçš„ä»»åŠ¡åœ¨æŒ‡å®šçš„æ—¶é—´å¼€å§‹è¿›è¡Œé‡å¤çš„å›ºå®šå»¶è¿Ÿæ‰§è¡Œã€‚
3. schedule(TimerTask task, long delay);
    - å®‰æ’åœ¨æŒ‡å®šå»¶è¿Ÿåæ‰§è¡ŒæŒ‡å®šçš„ä»»åŠ¡ã€‚æ³¨æ„è¿™ä¸ªæ–¹æ³•åªæ‰§è¡Œä¸€æ¬¡ã€‚
4. schedule(TimerTask task, long delay, long period);
    - å®‰æ’æŒ‡å®šçš„ä»»åŠ¡ä»æŒ‡å®šçš„å»¶è¿Ÿåå¼€å§‹è¿›è¡Œé‡å¤çš„å›ºå®šå»¶è¿Ÿæ‰§è¡Œã€‚æˆ‘ä»¬æ‰€éœ€è¦çš„å°±æ˜¯è¿™ä¸ªæ–¹æ³•ã€‚

### TimerTask

TimerTask ç±»æ˜¯ä¸€ä¸ªå®ç°Runnableæ¥å£çš„æŠ½è±¡ç±»ï¼Œç”± Timer å®‰æ’ä¸ºä¸€æ¬¡æ‰§è¡Œæˆ–é‡å¤æ‰§è¡Œçš„ä»»åŠ¡ã€‚å®ƒæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³• run() æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ç”¨äºæ‰§è¡Œç›¸åº”è®¡æ—¶å™¨ä»»åŠ¡è¦æ‰§è¡Œçš„æ“ä½œã€‚å› æ­¤æ¯ä¸€ä¸ªå…·ä½“çš„ä»»åŠ¡ç±»éƒ½å¿…é¡»ç»§æ‰¿ TimerTaskï¼Œç„¶åé‡å†™ run() æ–¹æ³•ã€‚

### ç¤ºä¾‹

åœ¨1såæ¯2sæ‰§è¡Œä¸€æ¬¡ã€‚


```java
    public class TimerTest {
        Timer timer;

        public TimerTest(){
            timer = new Timer();
            timer.schedule(new TimerTaskTest(), 1000, 2000);
        }

        public static void main(String[] args) {
            new TimerTest();
        }
    }

    public class TimerTaskTest extends TimerTask{

        @Override
        public void run() {
            Date date = new Date(this.scheduledExecutionTime());
            System.out.println("æœ¬æ¬¡æ‰§è¡Œè¯¥çº¿ç¨‹çš„æ—¶é—´ä¸ºï¼š" + date);
        }
    }
```

## æ€»ç»“

> è¦å¼€å‘å‡ºä¸€ä¸ªå¥½è½¯ä»¶ï¼Œæœ¬æ¥å°±æ˜¯å¾—æŠŠè‡ªå·±ä¹Ÿå½“æˆç”¨æˆ·

### è¿˜å¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹

å› ä¸ºæˆ‘ç°åœ¨è®²çš„æ˜¯æœ€ç®€å•çš„å®ç°ï¼Œå¦‚æœæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥å°†å®ƒæ”¹æ”¹ï¼Œæ¯”å¦‚è¯´ç”¨è§‚å¯Ÿè€…æ¨¡å¼é‡æ„ä¸€ä¸‹ã€Timerå†™ä¸ªå•ä¾‹æ¨¡å¼ã€é€šçŸ¥æˆå‘˜æ”¹æˆæ¥å£ï¼Œæ–¹ä¾¿ä»¥ååšå¾®ä¿¡é€šçŸ¥ã€æ•°æ®åº“åšä¸ªè®°å½•ã€å¢åŠ å¼‚å¸¸å¤„ç†æœºåˆ¶ç­‰ç­‰ç­‰ç­‰ï¼Œéƒ½æ˜¯å¯ä»¥æ”¹çš„ã€‚æ¬¢è¿å¤§å®¶åˆ°è¯„è®ºåŒºå’Œæˆ‘è®¨è®ºã€‚

### æˆ‘çš„åº”ç”¨åœ°å€

> [https://yaoyuxuan.cn/service](https://yaoyuxuan.cn/service)

æˆ‘è¿™ä¸ªä¼šé•¿æœŸç»´æŠ¤çš„ï¼Œç›´åˆ°å­¦é™¢æœ‰äº†ä½œä¸šé€šçŸ¥åŠŸèƒ½ã€‚

### æœ€åçš„è¯

è¿™ç¯‡æ–‡ç« å¦‚æœèƒ½å¹¸è¿åœ°è¢«å­¦é™¢é¢†å¯¼çœ‹è§ï¼Œéº»çƒ¦é¢†å¯¼ä»¬çœ‹çœ‹å°±å¥½ğŸ™ˆğŸ™ŠğŸ™‰ï¼Œè¿™ç§åŠŸèƒ½å¦‚æœåœ¨æºç ä¸Šæ¥å®ç°çš„è¯ï¼Œå…¶å®å¾ˆç®€å•çš„ã€‚

è¯·å„ä½å“¥å“¥å§å§ä»¬çœ‹åœ¨æˆ‘æ²¡å¹²è¿‡å•¥åäº‹çš„ä»½ä¸Šï¼Œè½»ç‚¹åæ§½è½»ç‚¹æQAQ
